<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Vocabulary App</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196F3">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .app-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .mode-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.9);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .mode-btn.active {
            background: #2196F3;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .mode-btn:hover {
            transform: translateY(-1px);
        }

        .mode-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 400px;
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #2196F3;
        }

        .btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #1976D2;
        }

        .btn-success {
            background: #4CAF50;
        }

        .btn-success:hover {
            background: #45a049;
        }

        .word-card {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .word-display {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2196F3;
        }

        .translation-display {
            font-size: 1.5em;
            color: #666;
            margin-bottom: 20px;
        }

        .study-stats {
            font-size: 0.9em;
            color: #888;
            margin-top: 15px;
        }

        .search-results {
            margin-top: 20px;
        }

        .result-item {
            background: #f8f9fa;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }

        .stats-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2196F3;
        }

        .hidden {
            display: none;
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app-header">
            <h1>üìö My Vocabulary</h1>
            <p>Learn words anywhere, anytime</p>
        </div>

        <div class="mode-selector">
            <button class="mode-btn active" onclick="showMode('add')">‚ûï Add Word</button>
            <button class="mode-btn" onclick="showMode('lookup')">üîç Look Up</button>
            <button class="mode-btn" onclick="showMode('learn')">üß† Learn</button>
        </div>

        <div class="mode-content">
            <!-- ADD WORD MODE -->
            <div id="add-mode" class="mode-section active">
                <h2>Add New Word</h2>
                <div class="input-group">
                    <label for="new-word">Word:</label>
                    <input type="text" id="new-word" placeholder="Enter word to learn">
                </div>
                <div class="input-group">
                    <label for="new-translation">Translation:</label>
                    <input type="text" id="new-translation" placeholder="Enter translation">
                </div>
                <div class="input-group">
                    <label for="new-category">Category (optional):</label>
                    <input type="text" id="new-category" placeholder="e.g., verbs, food, travel">
                </div>
                <button class="btn btn-success" onclick="addWord()">Add Word</button>
                <div id="add-message"></div>
                
                <div class="stats-display">
                    <div class="stat-box">
                        <div class="stat-number" id="total-words">0</div>
                        <div>Total Words</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="words-today">0</div>
                        <div>Added Today</div>
                    </div>
                </div>
            </div>

            <!-- LOOKUP MODE -->
            <div id="lookup-mode" class="mode-section">
                <h2>Look Up Word</h2>
                <div class="input-group">
                    <label for="search-word">Search:</label>
                    <input type="text" id="search-word" placeholder="Type word to search" oninput="searchWords()">
                </div>
                <div id="search-results" class="search-results"></div>
            </div>

            <!-- LEARN MODE -->
            <div id="learn-mode" class="mode-section">
                <h2>Study Session</h2>
                <div id="study-card" class="word-card">
                    <div id="study-word" class="word-display">Click "Start Learning" to begin</div>
                    <div id="study-translation" class="translation-display hidden"></div>
                    <div class="study-stats">
                        <span id="current-word-num">0</span> / <span id="total-study-words">0</span>
                    </div>
                </div>
                
                <div style="text-align: center; margin: 20px 0;">
                    <button class="btn" onclick="startLearning()" id="start-btn">Start Learning</button>
                    <button class="btn hidden" onclick="showTranslation()" id="show-btn">Show Translation</button>
                    <button class="btn btn-success hidden" onclick="markCorrect()" id="correct-btn">‚úì Correct</button>
                    <button class="btn hidden" onclick="markIncorrect()" id="incorrect-btn">‚úó Incorrect</button>
                    <button class="btn hidden" onclick="nextWord()" id="next-btn">Next Word</button>
                </div>

                <div class="stats-display">
                    <div class="stat-box">
                        <div class="stat-number" id="session-correct">0</div>
                        <div>Correct</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="session-total">0</div>
                        <div>Studied</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // App State
        let currentMode = 'add';
        let words = [];
        let currentWordIndex = 0;
        let studySession = {
            words: [],
            currentIndex: 0,
            correct: 0,
            total: 0
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            loadWords();
            updateStats();
            registerServiceWorker();
        });

        // Register Service Worker for PWA
        function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            }
        }

        // Storage Functions
        function saveWords() {
            localStorage.setItem('vocabularyWords', JSON.stringify(words));
        }

        function loadWords() {
            const stored = localStorage.getItem('vocabularyWords');
            words = stored ? JSON.parse(stored) : [];
        }

        // Mode Navigation
        function showMode(mode) {
            // Update buttons
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update content
            document.querySelectorAll('.mode-section').forEach(section => section.classList.remove('active'));
            document.getElementById(mode + '-mode').classList.add('active');
            
            currentMode = mode;
            
            if (mode === 'lookup') {
                document.getElementById('search-word').focus();
            } else if (mode === 'add') {
                document.getElementById('new-word').focus();
                updateStats();
            }
        }

        // ADD WORD Functions
        function addWord() {
            const word = document.getElementById('new-word').value.trim();
            const translation = document.getElementById('new-translation').value.trim();
            const category = document.getElementById('new-category').value.trim();
            
            if (!word || !translation) {
                showMessage('add-message', 'Please fill in both word and translation!', 'error');
                return;
            }
            
            // Check if word already exists
            if (words.find(w => w.word.toLowerCase() === word.toLowerCase())) {
                showMessage('add-message', 'This word already exists!', 'error');
                return;
            }
            
            const newWord = {
                id: Date.now(),
                word: word,
                translation: translation,
                category: category || 'general',
                studyCount: 0,
                correctCount: 0,
                createdDate: new Date().toISOString().split('T')[0],
                lastStudied: null
            };
            
            words.push(newWord);
            saveWords();
            
            // Clear inputs
            document.getElementById('new-word').value = '';
            document.getElementById('new-translation').value = '';
            document.getElementById('new-category').value = '';
            
            showMessage('add-message', 'Word added successfully!', 'success');
            updateStats();
            document.getElementById('new-word').focus();
        }

        // LOOKUP Functions
        function searchWords() {
            const query = document.getElementById('search-word').value.toLowerCase();
            const results = document.getElementById('search-results');
            
            if (!query) {
                results.innerHTML = '';
                return;
            }
            
            const matches = words.filter(w => 
                w.word.toLowerCase().includes(query) || 
                w.translation.toLowerCase().includes(query)
            );
            
            if (matches.length === 0) {
                results.innerHTML = '<div class="result-item">No words found</div>';
                return;
            }
            
            results.innerHTML = matches.map(word => `
                <div class="result-item">
                    <strong>${word.word}</strong> ‚Üí ${word.translation}
                    <br><small>Category: ${word.category} | Studied: ${word.studyCount} times</small>
                </div>
            `).join('');
        }

        // LEARN Functions
        function startLearning() {
            if (words.length === 0) {
                alert('Add some words first!');
                return;
            }
            
            studySession.words = [...words].sort(() => Math.random() - 0.5); // Shuffle
            studySession.currentIndex = 0;
            studySession.correct = 0;
            studySession.total = 0;
            
            document.getElementById('start-btn').classList.add('hidden');
            document.getElementById('show-btn').classList.remove('hidden');
            
            showCurrentStudyWord();
        }

        function showCurrentStudyWord() {
            const word = studySession.words[studySession.currentIndex];
            document.getElementById('study-word').textContent = word.word;
            document.getElementById('study-translation').classList.add('hidden');
            document.getElementById('current-word-num').textContent = studySession.currentIndex + 1;
            document.getElementById('total-study-words').textContent = studySession.words.length;
            
            // Show only the show translation button
            document.getElementById('show-btn').classList.remove('hidden');
            document.getElementById('correct-btn').classList.add('hidden');
            document.getElementById('incorrect-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
        }

        function showTranslation() {
            const word = studySession.words[studySession.currentIndex];
            document.getElementById('study-translation').textContent = word.translation;
            document.getElementById('study-translation').classList.remove('hidden');
            
            // Show correct/incorrect buttons
            document.getElementById('show-btn').classList.add('hidden');
            document.getElementById('correct-btn').classList.remove('hidden');
            document.getElementById('incorrect-btn').classList.remove('hidden');
        }

        function markCorrect() {
            const word = studySession.words[studySession.currentIndex];
            word.correctCount++;
            updateWordStats(word, true);
            studySession.correct++;
            nextWordOrFinish();
        }

        function markIncorrect() {
            const word = studySession.words[studySession.currentIndex];
            updateWordStats(word, false);
            nextWordOrFinish();
        }

        function updateWordStats(word, correct) {
            word.studyCount++;
            word.lastStudied = new Date().toISOString().split('T')[0];
            
            // Update the word in the main array
            const mainWordIndex = words.findIndex(w => w.id === word.id);
            if (mainWordIndex !== -1) {
                words[mainWordIndex] = word;
                saveWords();
            }
        }

        function nextWordOrFinish() {
            studySession.total++;
            updateSessionStats();
            
            document.getElementById('correct-btn').classList.add('hidden');
            document.getElementById('incorrect-btn').classList.add('hidden');
            
            if (studySession.currentIndex < studySession.words.length - 1) {
                document.getElementById('next-btn').classList.remove('hidden');
            } else {
                finishSession();
            }
        }

        function nextWord() {
            studySession.currentIndex++;
            document.getElementById('next-btn').classList.add('hidden');
            showCurrentStudyWord();
        }

        function finishSession() {
            const accuracy = Math.round((studySession.correct / studySession.total) * 100);
            document.getElementById('study-word').textContent = `Session Complete!`;
            document.getElementById('study-translation').textContent = `Accuracy: ${accuracy}%`;
            document.getElementById('study-translation').classList.remove('hidden');
            
            // Reset buttons
            document.getElementById('correct-btn').classList.add('hidden');
            document.getElementById('incorrect-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('start-btn').classList.remove('hidden');
            document.getElementById('start-btn').textContent = 'Start New Session';
        }

        // Utility Functions
        function updateStats() {
            document.getElementById('total-words').textContent = words.length;
            
            const today = new Date().toISOString().split('T')[0];
            const wordsToday = words.filter(w => w.createdDate === today).length;
            document.getElementById('words-today').textContent = wordsToday;
        }

        function updateSessionStats() {
            document.getElementById('session-correct').textContent = studySession.correct;
            document.getElementById('session-total').textContent = studySession.total;
        }

        function showMessage(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="message ${type}">${message}</div>`;
            setTimeout(() => element.innerHTML = '', 3000);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (currentMode === 'add' && e.key === 'Enter') {
                addWord();
            }
        });
    </script>
</body>
</html>